version: 2

models:
  - name: payments
    description: "This model combines payment acceptance data with chargeback information to provide a comprehensive view of payments."
    columns:
      - name: source_system
        data_type: varchar
        description: "The source system that processed the payment. Indicates which system the transaction comes from (e.g., Globepay)."


      - name: payment_key
        data_type: varchar
        description: "A surrogate key generated by combining the `payment_external_id` and `source_system`. Used to uniquely identify the payment transaction."
        tests:
          - dbt_constraints.primary_key

      - name: transaction_processed_at
        data_type: timestamp_ntz
        description: "Timestamp when the payment was processed by the system. Indicates when the transaction was finalized in the system."

      - name: was_transaction_accepted
        data_type: boolean
        description: "Indicates whether the payment was ACCEPTED (true) or DECLINED (false) by the payment processor."

      - name: was_card_verification_value_provided
        data_type: boolean
        description: "Indicates whether the card verification value (CVV) was provided during the transaction (true) or not (false)."


      - name: iso_country_code
        data_type: varchar
        description: "ISO country code of the card issuer or payment origin. Represents the country of the payment method used."


      - name: iso_currency_code
        data_type: varchar
        description: "ISO currency code of the transaction. Represents the currency used in the payment (e.g., USD, EUR)."


      - name: amount_charged_local_currency
        data_type: number
        description: "The amount charged in the local currency of the transaction. Represents the value deducted from the payerâ€™s card in their local currency."

      - name: exchange_rate
        data_type: number
        description: "The exchange rate applied to convert the amount charged in local currency to the equivalent amount in USD."


      - name: amount_charged_usd
        data_type: number
        description: "The amount charged in USD, converted from the local currency using the exchange rate."


      - name: was_payment_charged_back
        data_type: boolean
        description: "Indicates whether the payment was charged back (true) or not (false)."

      - name: has_chargedback_information
        data_type: boolean
        description: "Indicates whether the transaction has associated chargeback information. Returns `true` if chargeback data is present, otherwise `false`."              